
2023-07-14T17:27:59Z    INFO    admission       >>>>start new webhook handle    {"object": {"name":"app-sample","namespace":"default"}, "namespace": "default", "name": "app-sample", "resource": {"group":"apps","version":"v1","resource":"deployments"}, "user": "system:serviceaccount:kubebuilder-demo-v3-system:kubebuilder-demo-v3-controller-manager", "requestID": "a4b9ae54-ab2e-437e-bd52-faefd65b5d79"}
2023-07-14T17:27:59Z    INFO    admission       >>>>>work load -> deployment Handle: res name=app-sample,user=system:serviceaccount:kubebuilder-demo-v3-system:kubebuilder-demo-v3-controller-manager,Operation=CREATE     {"object": {"name":"app-sample","namespace":"default"}, "namespace": "default", "name": "app-sample", "resource": {"group":"apps","version":"v1","resource":"deployments"}, "user": "system:serviceaccount:kubebuilder-demo-v3-system:kubebuilder-demo-v3-controller-manager", "requestID": "a4b9ae54-ab2e-437e-bd52-faefd65b5d79"}
2023/07/14 17:27:59 http: panic serving 10.42.0.1:58376: runtime error: invalid memory address or nil pointer dereference
goroutine 223 [running]:
net/http.(*conn).serve.func1()
        D:/Go/src/net/http/server.go:1854 +0xbf
panic({0x16c41a0, 0x2686f90})
        D:/Go/src/runtime/panic.go:890 +0x263
sigs.k8s.io/controller-runtime/pkg/webhook/admission.(*Decoder).DecodeRaw(0x0, {{0xc0007a3200, 0x82e, 0x900}, {0x0, 0x0}}, {0x1afa508, 0xc0007e2000})
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/webhook/admission/decode.go:76 +0x13a
sigs.k8s.io/controller-runtime/pkg/webhook/admission.(*Decoder).Decode(_, {{{0xc000780e10, 0x24}, {{0xc0002f16e8, 0x4}, {0xc0002f16ec, 0x2}, {0xc0002f1710, 0xa}}, {{0xc0002f171c, ...}, ...}, ...}}, ...)
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/webhook/admission/decode.go:49 +0x8e
github.com/kubebuilder-demo/workload.(*DeployWrapper).Handle(_, {_, _}, {{{0xc000780e10, 0x24}, {{0xc0002f16e8, 0x4}, {0xc0002f16ec, 0x2}, {0xc0002f1710, ...}}, ...}})
        D:/BASESOFT/kubebuilder-demo-v3/workload/deployment.go:32 +0x34f
sigs.k8s.io/controller-runtime/pkg/webhook/admission.(*Webhook).Handle(_, {_, _}, {{{0xc000780e10, 0x24}, {{0xc0002f16e8, 0x4}, {0xc0002f16ec, 0x2}, {0xc0002f1710, ...}}, ...}})
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/webhook/admission/webhook.go:169 +0x20a
sigs.k8s.io/controller-runtime/pkg/webhook/admission.(*Webhook).ServeHTTP(0xc000269b80, {0x7fa7403ac578?, 0xc0003c3310}, 0xc0002e4700)
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/webhook/admission/http.go:98 +0xc94
github.com/prometheus/client_golang/prometheus/promhttp.InstrumentHandlerInFlight.func1({0x7fa7403ac578, 0xc0003c3310}, 0x1b0ab00?)
        D:/GOPATH/pkg/mod/github.com/prometheus/client_golang@v1.15.1/prometheus/promhttp/instrument_server.go:60 +0xd4
net/http.HandlerFunc.ServeHTTP(0x1b0ab30?, {0x7fa7403ac578?, 0xc0003c3310?}, 0xc000775828?)
        D:/Go/src/net/http/server.go:2122 +0x2f
github.com/prometheus/client_golang/prometheus/promhttp.InstrumentHandlerCounter.func1({0x1b0ab30?, 0xc00078e460?}, 0xc0002e4700)
        D:/GOPATH/pkg/mod/github.com/prometheus/client_golang@v1.15.1/prometheus/promhttp/instrument_server.go:147 +0xc5
net/http.HandlerFunc.ServeHTTP(0x6fdbe5?, {0x1b0ab30?, 0xc00078e460?}, 0x7fa767a69108?)
        D:/Go/src/net/http/server.go:2122 +0x2f
github.com/prometheus/client_golang/prometheus/promhttp.InstrumentHandlerDuration.func2({0x1b0ab30, 0xc00078e460}, 0xc0002e4700)
        D:/GOPATH/pkg/mod/github.com/prometheus/client_golang@v1.15.1/prometheus/promhttp/instrument_server.go:109 +0xc7
net/http.HandlerFunc.ServeHTTP(0xc00078e460?, {0x1b0ab30?, 0xc00078e460?}, 0x18b06c1?)
        D:/Go/src/net/http/server.go:2122 +0x2f
net/http.(*ServeMux).ServeHTTP(0xc000427c22?, {0x1b0ab30, 0xc00078e460}, 0xc0002e4700)
        D:/Go/src/net/http/server.go:2500 +0x149
net/http.serverHandler.ServeHTTP({0x1afd4d8?}, {0x1b0ab30, 0xc00078e460}, 0xc0002e4700)
        D:/Go/src/net/http/server.go:2936 +0x316
net/http.(*conn).serve(0xc0000d9050, {0x1b0b750, 0xc000091320})
        D:/Go/src/net/http/server.go:1995 +0x612
created by net/http.(*Server).Serve
        D:/Go/src/net/http/server.go:3089 +0x5ed
{"uid":"a4b9ae54-ab2e-437e-bd52-faefd65b5d79","kind":{"group":"apps","version":"v1","kind":"Deployment"},"resource":{"group":"apps","version":"v1","resource":"deployments"},"requestKind":{"group":"apps","version":"v1","kind":"Deployment"},"requestResource":{"group":"apps","version":"v1","resource":"deployments"},"name":"app-sample","namespace":"default","operation":"CREATE","userInfo":{"username":"system:serviceaccount:kubebuilder-demo-v3-system:kubebuilder-demo-v3-controller-manager","uid":"c5a2c808-b8d4-4b99-b995-2d42a15a5dd9","groups":["system:serviceaccounts","system:serviceaccounts:kubebuilder-demo-v3-system","system:authenticated"],"extra":{"authentication.kubernetes.io/pod-name":["kubebuilder-demo-v3-controller-manager-6547b8fbbf-7kv7s"],"authentication.kubernetes.io/pod-uid":["4bdec3eb-aa1b-4732-aaf2-23314c396896"]}},"object":{"kind":"Deployment","apiVersion":"apps/v1","metadata":{"name":"app-sample","namespace":"default","uid":"b184bcf2-c680-4b27-949e-b840b3aee503","generation":1,"creationTimestamp":"2023-07-14T17:27:59Z","labels":{"app":"app-sample"},"ownerReferences":[{"apiVersion":"ingress.baiding.tech/v1beta1","kind":"App","name":"app-sample","uid":"7b52dfe4-1c34-493f-ac77-153c88cc252f","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"Go-http-client","operation":"Update","apiVersion":"apps/v1","time":"2023-07-14T17:27:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"7b52dfe4-1c34-493f-ac77-153c88cc252f\"}":{}}},"f:spec":{"f:progressDeadlineSeconds":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:strategy":{"f:rollingUpdate":{".":{},"f:maxSurge":{},"f:maxUnavailable":{}},"f:type":{}},"f:template":{"f:metadata":{"f:labels":{".":{},"f:app":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"app-sample\"}":{".":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":8080,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:protocol":{}}},"f:resources":{},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"app-sample"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app":"app-sample"}},"spec":{"containers":[{"name":"app-sample","image":"nginx:latest","ports":[{"containerPort":8080,"protocol":"TCP"}],"resources":{},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","securityContext":{},"schedulerName":"default-scheduler"}},"strategy":{"type":"RollingUpdate","rollingUpdate":{"maxUnavailable":"25%","maxSurge":"25%"}},"revisionHistoryLimit":10,"progressDeadlineSeconds":600},"status":{}},"oldObject":null,"dryRun":false,"options":{"kind":"CreateOptions","apiVersion":"meta.k8s.io/v1"}}
2023-07-14T17:27:59Z    ERROR   create deploy failed    {"controller": "app", "controllerGroup": "ingress.baiding.tech", "controllerKind": "App", "App": {"name":"app-sample","namespace":"default"}, "namespace": "default", "name": "app-sample", "reconcileID": "a9bc892c-c065-404a-9c98-932ce54890be", "error": "Internal error occurred: failed calling webhook \"mdeploy.kb.io\": failed to call webhook: Post \"https://kubebuilder-demo-v3-webhook-service.kubebuilder-demo-v3-system.svc:443/validate-apps-v1-deployment?timeout=10s\": EOF"}
github.com/kubebuilder-demo/internal/controller.(*AppReconciler).Reconcile
        D:/BASESOFT/kubebuilder-demo-v3/internal/controller/app_controller.go:78
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/internal/controller/controller.go:118
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/internal/controller/controller.go:314
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/internal/controller/controller.go:265
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/internal/controller/controller.go:226
2023-07-14T17:27:59Z    ERROR   Reconciler error        {"controller": "app", "controllerGroup": "ingress.baiding.tech", "controllerKind": "App", "App": {"name":"app-sample","namespace":"default"}, "namespace": "default", "name": "app-sample", "reconcileID": "a9bc892c-c065-404a-9c98-932ce54890be", "error": "Internal error occurred: failed calling webhook \"mdeploy.kb.io\": failed to call webhook: Post \"https://kubebuilder-demo-v3-webhook-service.kubebuilder-demo-v3-system.svc:443/validate-apps-v1-deployment?timeout=10s\": EOF"}
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/internal/controller/controller.go:324
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/internal/controller/controller.go:265
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
        D:/GOPATH/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.0/pkg/internal/controller/controller.go:226
a